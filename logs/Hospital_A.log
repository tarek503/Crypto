2025-11-10 12:10:45 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:10:45 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:10:45 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:10:45 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:10:45 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:10:45 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:10:45 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:10:45 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:10:45 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:10:45 [INFO] [Hospital_A] Node running. This CLI is for testing. In production, drive approvals & requests via a real UI.
2025-11-10 12:10:45 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:10:58 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:10:58 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=8c7219e2facbbe52f41efc7a7921e5b3...
2025-11-10 12:10:58 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:10:58 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt' to Hospital_B...
2025-11-10 12:11:15 [INFO] [Hospital_A] Encrypted package received. Decoding...
2025-11-10 12:11:15 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=ffc9858ae1ce985d4d17f86b3f373120 | ciphertext_len=112 | hmac_len=32 | hmac_preview=b1506b5a9ae494e3863388618f1ba1d0...
2025-11-10 12:11:15 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:11:15 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=e63c545412bfb06e16851745497cb740...
2025-11-10 12:11:15 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=e63c545412bfb06e... | hmac_key_len=32 | hmac_key_preview=9a1f91fbe99b5bc2...
2025-11-10 12:11:15 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:11:15 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:11:15 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=ffc9858ae1ce985d4d17f86b3f373120
2025-11-10 12:11:15 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:11:15 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 12:14:29 [INFO] [Hospital_A] Shutting down by user request...
2025-11-10 12:14:29 [INFO] [Hospital_A] Server stop signal set.
2025-11-10 12:14:54 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:14:54 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:14:54 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:14:54 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:14:54 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:14:54 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:14:54 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:14:54 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:14:54 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:14:54 [INFO] [Hospital_A] Node running. This CLI is for testing. In production, drive approvals & requests via a real UI.
2025-11-10 12:14:54 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:14:56 [INFO] [Hospital_A] Shutting down by user request...
2025-11-10 12:14:56 [INFO] [Hospital_A] Server stop signal set.
2025-11-10 12:20:24 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:20:24 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:20:24 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:20:24 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:20:24 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:20:24 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:20:24 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:20:24 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:20:24 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:20:24 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:23:57 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:23:57 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:23:57 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:23:57 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:23:57 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:23:57 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:23:57 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:23:57 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:23:57 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:24:09 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:24:09 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:24:09 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:24:09 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:24:09 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:24:09 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:24:09 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:24:09 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:24:09 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:24:09 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:24:42 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:24:42 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=3ad7ca10261d80b5201ff82a4c49455c...
2025-11-10 12:24:42 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:8002...
2025-11-10 12:24:42 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt' to Hospital_B...
2025-11-10 12:37:14 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:37:14 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:37:14 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:37:14 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:37:14 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:37:14 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:37:14 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:37:14 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:37:14 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:37:14 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:38:10 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:38:10 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=6aad8ef5e250fe1a20872fa26072a0b1...
2025-11-10 12:38:10 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:38:10 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:38:14 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 12:38:14 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=0ae69d1bf5555e9a037690a4004f4305 | ciphertext_len=112 | hmac_len=32 | hmac_preview=caf61ab6749f78fb44824b937d73e8ac...
2025-11-10 12:38:14 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:38:14 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=c1496b8d545c61b202f0aeff9fbf1f89...
2025-11-10 12:38:14 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=c1496b8d545c61b2... | hmac_key_len=32 | hmac_key_preview=660d0e28d39918d7...
2025-11-10 12:38:14 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:38:14 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:38:14 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=0ae69d1bf5555e9a037690a4004f4305
2025-11-10 12:38:14 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:38:14 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 12:42:51 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:42:51 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:42:51 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:42:51 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:42:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:42:51 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:42:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:42:51 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:42:51 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:42:51 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:43:30 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:43:30 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=1f174cffcff72d62ffc8b22dc5513aa0...
2025-11-10 12:43:30 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:43:30 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:43:35 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 12:43:38 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:43:38 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=2fd7a0dbd279c7c1c13bcb6930ce5b05...
2025-11-10 12:43:38 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:43:38 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:43:43 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 12:43:43 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=b430fd87beb9f2be27bf48682b1b41ae | ciphertext_len=112 | hmac_len=32 | hmac_preview=7bec51859aba591c1e27ee14d6063b2f...
2025-11-10 12:43:43 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:43:43 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=e2b53196907f9e6445e91a52e9480207...
2025-11-10 12:43:43 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=e2b53196907f9e64... | hmac_key_len=32 | hmac_key_preview=1e5b9762d413d257...
2025-11-10 12:43:43 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:43:43 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:43:43 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=b430fd87beb9f2be27bf48682b1b41ae
2025-11-10 12:43:43 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:43:43 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 12:50:51 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 12:50:51 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 12:50:51 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 12:50:51 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 12:50:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 12:50:51 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 12:50:51 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 12:50:51 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 12:50:51 [INFO] [Hospital_A] Background server thread started.
2025-11-10 12:50:51 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 12:51:37 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:51:37 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=5a119c8effeafbe8103d867f63513b96...
2025-11-10 12:51:37 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:51:37 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:51:42 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 12:51:47 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 12:51:47 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=84f428e3964a9a39efe42835a5c1e683...
2025-11-10 12:51:47 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 12:51:47 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 12:51:49 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 12:51:49 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=74d4456afbbc1e61edd79e374164e722 | ciphertext_len=112 | hmac_len=32 | hmac_preview=96443d642c882ced979822816ffadd74...
2025-11-10 12:51:49 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 12:51:49 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=7556b5ba47e5c1bcf571bcd6f188a399...
2025-11-10 12:51:49 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=7556b5ba47e5c1bc... | hmac_key_len=32 | hmac_key_preview=08629d1b92b575bc...
2025-11-10 12:51:49 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 12:51:49 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 12:51:49 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=74d4456afbbc1e61edd79e374164e722
2025-11-10 12:51:49 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 12:51:49 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 13:02:17 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 13:02:17 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 13:02:17 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 13:02:17 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 13:02:17 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 13:02:17 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 13:02:17 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 13:02:17 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 13:02:17 [INFO] [Hospital_A] Background server thread started.
2025-11-10 13:02:17 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 13:03:04 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:03:04 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=6909b2ae97c7e11f2b34073fa75a2ae9...
2025-11-10 13:03:04 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:03:04 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:03:07 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:03:33 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:03:33 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=2481a81610a6c5f173e934ea9e7bd877...
2025-11-10 13:03:33 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:03:33 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:03:37 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:03:55 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:03:55 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=25dfc7fceec27bea8b49ba610be501d5...
2025-11-10 13:03:55 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:03:55 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:03:58 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:03:58 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=75e21debb1f7333ca7a2af513da1f8b4 | ciphertext_len=112 | hmac_len=32 | hmac_preview=d1a0312b42a656ca9154203d67b8ce50...
2025-11-10 13:03:58 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:03:58 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=b2db73ff6a246833e68855704ec7d4d5...
2025-11-10 13:03:58 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=b2db73ff6a246833... | hmac_key_len=32 | hmac_key_preview=b62a749e73a6269f...
2025-11-10 13:03:58 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 13:03:58 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:03:58 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=75e21debb1f7333ca7a2af513da1f8b4
2025-11-10 13:03:58 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 13:03:58 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 13:04:28 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:04:28 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=66edb3eb447800f33c47e569be9dbd0e...
2025-11-10 13:04:28 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:04:28 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:04:33 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:05:47 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:05:47 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=01af0f0f0bfca40b0503952a5efd3baa...
2025-11-10 13:05:47 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:05:47 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:05:52 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:06:06 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:06:06 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=1411a175630e33d10bffa3423023e5df...
2025-11-10 13:06:06 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:06:06 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:06:09 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:06:11 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:06:11 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=6d4c1c0568b70ea09c0da215909b3caf...
2025-11-10 13:06:11 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:06:11 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:06:15 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:06:15 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=362e7a1e6c2530e04f4051ff6988b2f5 | ciphertext_len=16 | hmac_len=32 | hmac_preview=6672938815097a32abf986cb94862537...
2025-11-10 13:06:15 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:06:15 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=81c8f068f476a8ff91475cd4215e71ee...
2025-11-10 13:06:15 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=81c8f068f476a8ff... | hmac_key_len=32 | hmac_key_preview=e454010c96415ea3...
2025-11-10 13:06:15 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=16
2025-11-10 13:06:15 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:06:15 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=16 | iv_hex=362e7a1e6c2530e04f4051ff6988b2f5
2025-11-10 13:06:15 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=6 | plaintext_preview=616c6f6f6f6f
2025-11-10 13:06:15 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_ba7bou7a.txt'
2025-11-10 13:14:03 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 13:14:03 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 13:14:03 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 13:14:03 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 13:14:03 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 13:14:03 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 13:14:03 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 13:14:03 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 13:14:03 [INFO] [Hospital_A] Background server thread started.
2025-11-10 13:14:03 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 13:15:00 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:15:00 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=4781a694fc73e222036a60970ef8fe3e...
2025-11-10 13:15:00 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:15:00 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:15:05 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:15:29 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 13:15:29 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=01ad7bc67b8c82a2c3f7b1f71541a394...
2025-11-10 13:15:29 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:15:29 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 13:15:33 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:15:33 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=1fd30e6b963d01b78cc13c8b3587a96b | ciphertext_len=112 | hmac_len=32 | hmac_preview=3776d0a39ddb4311f1781a797eb92657...
2025-11-10 13:15:33 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:15:33 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=3058f2a224cbdd1b0c46eddb584f292a...
2025-11-10 13:15:33 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=3058f2a224cbdd1b... | hmac_key_len=32 | hmac_key_preview=a7e5b33a932d186f...
2025-11-10 13:15:33 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 13:15:33 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:15:33 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=1fd30e6b963d01b78cc13c8b3587a96b
2025-11-10 13:15:33 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 13:15:33 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
2025-11-10 13:15:41 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:15:41 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=4f7a9dbcf8d6d5d52d55237917475461...
2025-11-10 13:15:41 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:15:41 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:15:44 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 13:23:29 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 13:23:29 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 13:23:29 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 13:23:29 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 13:23:29 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 13:23:29 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 13:23:29 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 13:23:29 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 13:23:29 [INFO] [Hospital_A] Background server thread started.
2025-11-10 13:23:29 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 13:24:29 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:24:29 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=1b51b21990c3740c956eb9eec106ec3d...
2025-11-10 13:24:29 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:24:29 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:24:34 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 13:24:38 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:ba7bou7a.txt
2025-11-10 13:24:38 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=00e766348b65cc878c5e7c757f8705cd...
2025-11-10 13:24:38 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 13:24:38 [INFO] [Hospital_A] Sending secure request for 'ba7bou7a.txt'...
2025-11-10 13:24:40 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 13:24:40 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=3ae5d20216782fecfd2c02add7b2589f | ciphertext_len=16 | hmac_len=32 | hmac_preview=d9ccb34acbabe2637de7aede14df947b...
2025-11-10 13:24:40 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 13:24:40 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=ca6df4fb7887e971dd1d80fbb33947b2...
2025-11-10 13:24:40 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=ca6df4fb7887e971... | hmac_key_len=32 | hmac_key_preview=4a59b2426cb29635...
2025-11-10 13:24:40 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=16
2025-11-10 13:24:40 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 13:24:40 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=16 | iv_hex=3ae5d20216782fecfd2c02add7b2589f
2025-11-10 13:24:40 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=6 | plaintext_preview=616c6f6f6f6f
2025-11-10 13:24:40 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_ba7bou7a.txt'
2025-11-10 13:25:15 [INFO] [Hospital_A] Accepted connection from ('127.0.0.1', 50313)
2025-11-10 13:25:15 [INFO] [Hospital_A] Request_Received | from_hospital=Hospital_B | message_preview=Request:patient_123.txt | signature_len=256 | signature_preview=09a146711c7e90d7c2dbaf7301fef0e3...
2025-11-10 13:25:15 [INFO] [Hospital_A] VerifySignature_Start | algo=RSA | hash=SHA-256
2025-11-10 13:25:15 [INFO] [Hospital_A] VerifySignature_Success | note=Requester authenticated
2025-11-10 13:25:15 [INFO] [Hospital_A] Valid request for 'patient_123.txt' from Hospital_B
2025-11-10 13:25:15 [INFO] [Hospital_A] Approval pending: id=a2377efa-2ba1-439d-91bd-9d77427849c2, from=Hospital_B, file=patient_123.txt
2025-11-10 13:25:15 [DEBUG] [Hospital_A] Waiting for decision: id=a2377efa-2ba1-439d-91bd-9d77427849c2, requester=Hospital_B, file=patient_123.txt
2025-11-10 13:25:15 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:16 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:17 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:17 [INFO] [Hospital_A] Pending approvals count=1
2025-11-10 13:25:18 [INFO] [Hospital_A] Staff APPROVED request_id=a2377efa-2ba1-439d-91bd-9d77427849c2 from=Hospital_B file=patient_123.txt
2025-11-10 13:25:18 [INFO] [Hospital_A] Request a2377efa-2ba1-439d-91bd-9d77427849c2 approved. Encrypting and sending...
2025-11-10 13:25:18 [INFO] [Hospital_A] File_Read | file=patient_123.txt | size=103 | preview=50415449454e54205245434f52443a20...
2025-11-10 13:25:18 [INFO] [Hospital_A] SessionKeys_Generated | aes_key_len=32 | aes_key_preview=bf465d67e2d5b6d5... | hmac_key_len=32 | hmac_key_preview=6e2d654b93115587...
2025-11-10 13:25:18 [INFO] [Hospital_A] AES_Encrypt_Done | iv_hex=c7028230313b4ad4cd88ea293a060547 | plaintext_len=103 | ciphertext_len=112 | ciphertext_preview=9deae808a79b277fa6e282cc60e975eb...
2025-11-10 13:25:18 [INFO] [Hospital_A] HMAC_Generate_Done | tag_len=32 | tag_preview=d0e59fcb5e84283c829cf99abfd360dc...
2025-11-10 13:25:18 [INFO] [Hospital_A] RSA_EncryptKeys_Start | combined_len=64 | combined_preview=bf465d67e2d5b6d56f609d81ef351598...
2025-11-10 13:25:18 [INFO] [Hospital_A] RSA_EncryptKeys_Done | enc_keys_len=256 | enc_keys_preview=16e2c629f04e85303f7406825b5bbee9...
2025-11-10 13:25:18 [INFO] [Hospital_A] Secure package for 'patient_123.txt' sent to Hospital_B.
2025-11-10 13:25:18 [INFO] [Hospital_A] Connection from Hospital_B closed.
2025-11-10 21:13:08 [INFO] [Hospital_A] Initializing node with cryptographic material...
2025-11-10 21:13:08 [INFO] [Hospital_A] Loading private key from 'Hospital_A_private.pem'...
2025-11-10 21:13:08 [INFO] [Hospital_A] PrivateKeyLoaded | source=Hospital_A_private.pem
2025-11-10 21:13:08 [INFO] [Hospital_A] Loading public key for Hospital_A from 'Hospital_A_public.pem'...
2025-11-10 21:13:08 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_A | source=Hospital_A_public.pem
2025-11-10 21:13:08 [INFO] [Hospital_A] Loading public key for Hospital_B from 'Hospital_B_public.pem'...
2025-11-10 21:13:08 [INFO] [Hospital_A] PublicKeyLoaded | owner=Hospital_B | source=Hospital_B_public.pem
2025-11-10 21:13:08 [INFO] [Hospital_A] Directories ready: data_dir='hospital_A_data', received_dir='hospital_A_received'
2025-11-10 21:13:08 [INFO] [Hospital_A] Background server thread started.
2025-11-10 21:13:08 [INFO] [Hospital_A] Server listening on 0.0.0.0:65001
2025-11-10 21:16:35 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 21:16:35 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=330e5cc93b369e54075adb63e77696e3...
2025-11-10 21:16:35 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 21:16:35 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 21:16:40 [ERROR] [Hospital_A] Connection to 127.0.0.1:65002 timed out.
2025-11-10 21:17:29 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 21:17:29 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=4021d5b18b82a1929b02075e30d64d06...
2025-11-10 21:17:29 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 21:17:29 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 21:17:32 [WARNING] [Hospital_A] Server error response: Request Denied.
2025-11-10 21:17:40 [INFO] [Hospital_A] SignMessage_Start | algo=RSA | hash=SHA-256 | message_preview=Request:patient_123.txt
2025-11-10 21:17:40 [INFO] [Hospital_A] SignMessage_Done | signature_len=256 | signature_preview=571e70f00158126e20a47ea0ae6ef1f7...
2025-11-10 21:17:40 [INFO] [Hospital_A] Connecting to Hospital_B at 127.0.0.1:65002...
2025-11-10 21:17:40 [INFO] [Hospital_A] Sending secure request for 'patient_123.txt'...
2025-11-10 21:17:43 [INFO] [Hospital_A] Encrypted package received, decoding JSON...
2025-11-10 21:17:43 [INFO] [Hospital_A] EncryptedPackage_Received | enc_keys_len=256 | iv_hex=4d5cdab5eabc835ca60504bf784d219e | ciphertext_len=112 | hmac_len=32 | hmac_preview=e09b2b8f779656e0dc3978ae0da7426b...
2025-11-10 21:17:43 [INFO] [Hospital_A] RSA_DecryptKeys_Start | algo=RSA | enc_keys_len=256
2025-11-10 21:17:43 [INFO] [Hospital_A] RSA_DecryptKeys_Done | combined_len=64 | combined_preview=70278c7b3fed7dde25981276ffc8cee0...
2025-11-10 21:17:43 [INFO] [Hospital_A] SessionKeys_Derived | aes_key_len=32 | aes_key_preview=70278c7b3fed7dde... | hmac_key_len=32 | hmac_key_preview=432bf457a55bd356...
2025-11-10 21:17:43 [INFO] [Hospital_A] HMAC_Verify_Start | algo=HMAC-SHA256 | ciphertext_len=112
2025-11-10 21:17:43 [INFO] [Hospital_A] HMAC_Verify_Success | note=Integrity OK
2025-11-10 21:17:43 [INFO] [Hospital_A] AES_Decrypt_Start | algo=AES-256-CBC | ciphertext_len=112 | iv_hex=4d5cdab5eabc835ca60504bf784d219e
2025-11-10 21:17:43 [INFO] [Hospital_A] AES_Decrypt_Done | plaintext_len=103 | plaintext_preview=50415449454e54205245434f52443a20...
2025-11-10 21:17:43 [INFO] [Hospital_A] Decrypted record saved to 'hospital_A_received\RECEIVED_patient_123.txt'
